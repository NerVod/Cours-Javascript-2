<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>JavaScript & DOM : Le Mod√®le Objet du Document - Exercice 16</title>
    <script>
      


      var interpolationDuSprite = {
        positionDeBase: [{
          widthContainer: 61 +'px',
          heightContainer: 100 +'px',
          margeHaut: 0 +'px',
          margeGauche: -4 + 'px',
          margeDivgauche: 1+'px',
          margedivHaut: 1+'px',
        },],
        avancer: [{
          widthContainer: 69 +'px',
          heightContainer: 94 +'px',
          margeHaut: -203 +'px',
          margeGauche: 0 + 'px',
          margeAgauche: 2,
          margeEnHaut: 0,
        },          
        {
          widthContainer: 100 +'px',
          heightContainer: 94 +'px',
          margeHaut: -203 +'px',
          margeGauche: -72 + 'px',
          margeAgauche: 2,
          margeEnHaut: 0,
        },
        {
          widthContainer: 60 +'px',
          heightContainer: 94 +'px',
          margeHaut: -203 +'px',
          margeGauche: -172 + 'px',
          margeAgauche: 2,
          margeEnHaut: 0,
        },
        {
          widthContainer: 81 +'px',
          heightContainer: 94 +'px',
          margeHaut: -203 +'px',
          margeGauche: -237 + 'px',
          margeAgauche: 2,
          margeEnHaut: 0,
        },
        {
          widthContainer: 64 +'px',
          heightContainer: 94 +'px',
          margeHaut: -199 +'px',
          margeGauche: -317 + 'px',
          margeAgauche: 2,
          margeEnHaut: 0,
        },
        {
          widthContainer: 88 +'px',
          heightContainer: 94 +'px',
          margeHaut: -199 +'px',
          margeGauche: -378 + 'px',
          margeAgauche: 2,
          margeEnHaut: 0,
        },
        {
          widthContainer: 58 +'px',
          heightContainer: 94 +'px',
          margeHaut: -199 +'px',
          margeGauche: -462 + 'px',
          margeAgauche: 2,
          margeEnHaut: 0,
        },
        {
          widthContainer: 72 +'px',
          heightContainer: 87 +'px',
          margeHaut: -196 +'px',
          margeGauche: -525 + 'px',
          margeAgauche: 2,
          margeEnHaut: 0,
        },
        {
          widthContainer: 61 +'px',
          heightContainer: 100 +'px',
          margeHaut: 0 +'px',
          margeGauche: -4 + 'px',
          margeAgauche: 2,
          margeEnHaut: 0,
        },
      ],
        reculer: [{
          widthContainer: 69 +'px',
          heightContainer: 94 +'px',
          margeHaut: -203 +'px',
          margeGauche: 0 + 'px',
          margeAgauche: -2,
          margeEnHaut: 0,
        },          
        {
          widthContainer: 100 +'px',
          heightContainer: 94 +'px',
          margeHaut: -203 +'px',
          margeGauche: -72 + 'px',
          margeAgauche: -2,
          margeEnHaut: 0,
        },
        {
          widthContainer: 60 +'px',
          heightContainer: 94 +'px',
          margeHaut: -203 +'px',
          margeGauche: -172 + 'px',
          margeAgauche: -2,
          margeEnHaut: 0,
        },
        {
          widthContainer: 81 +'px',
          heightContainer: 94 +'px',
          margeHaut: -203 +'px',
          margeGauche: -237 + 'px',
          margeAgauche: -2,
          margeEnHaut: 0,
        },
        {
          widthContainer: 64 +'px',
          heightContainer: 94 +'px',
          margeHaut: -199 +'px',
          margeGauche: -317 + 'px',
          margeAgauche: -2,
          margeEnHaut: 0,
        },
        {
          widthContainer: 88 +'px',
          heightContainer: 94 +'px',
          margeHaut: -199 +'px',
          margeGauche: -378 + 'px',
          margeAgauche: -2,
          margeEnHaut: 0,
        },
        {
          widthContainer: 58 +'px',
          heightContainer: 94 +'px',
          margeHaut: -199 +'px',
          margeGauche: -462 + 'px',
          margeAgauche: -2,
          margeEnHaut: 0,
        },
        {
          widthContainer: 72 +'px',
          heightContainer: 87 +'px',
          margeHaut: -196 +'px',
          margeGauche: -525 + 'px',
          margeAgauche: -2,
          margeEnHaut: 0,
        },
        {
          widthContainer: 61 +'px',
          heightContainer: 100 +'px',
          margeHaut: 0 +'px',
          margeGauche: -4 + 'px',
          margeAgauche: -2,
          margeEnHaut: 0,
        },
      ],




        sauter: [{
          widthContainer: 58 +'px',
          heightContainer: 89 +'px',
          margeHaut: -119 +'px',
          margeGauche: -8 + 'px',
          margeDivgauche:0,
          margedivHaut: -2,
        }, //1         
        {
          widthContainer: 58 +'px',
          heightContainer: 106 +'px',
          margeHaut: -108 +'px',
          margeGauche: -60 + 'px',
          margeDivgauche:0,
          margedivHaut: -2,
        },//2
        {
          widthContainer: 58 +'px',
          heightContainer: 104 +'px',
          margeHaut: -108 +'px',
          margeGauche: -113 + 'px',
          margeDivgauche:0,
          margedivHaut: -2,
        },//3
        {
          widthContainer: 58 +'px',
          heightContainer: 96 +'px',
          margeHaut: -108 +'px',
          margeGauche: -167 + 'px',
          margeDivgauche:0,
          margedivHaut: -2,
        },//4
        {
          widthContainer: 58 +'px',
          heightContainer: 96 +'px',
          margeHaut: -108 +'px',
          margeGauche: -222+ 'px',
          margeDivgauche:0,
          margedivHaut: -2,
        },//5
        {
          widthContainer: 58 +'px',
          heightContainer: 96 +'px',
          margeHaut: -108 +'px',
          margeGauche: -279 + 'px',
          margeDivgauche:0,
          margedivHaut: -2,
        },//6
        {
          widthContainer: 58 +'px',
          heightContainer: 94 +'px',
          margeHaut: -199 +'px',
          margeGauche: -462 + 'px',
          margeDivgauche:0,
          margedivHaut: -2,
        },//7
        {
          widthContainer: 70 +'px',
          heightContainer: 93 +'px',
          margeHaut: -108 +'px',
          margeGauche: -394 + 'px',
          margeDivgauche:0,
          margedivHaut: -2,
        },//8
        {
          widthContainer: 65 +'px',
          heightContainer: 93 +'px',
          margeHaut: -108 +'px',
          margeGauche: -461 + 'px',
          margeDivgauche:0,
          margedivHaut: -2,
        },//9
        {
          widthContainer: 81 +'px',
          heightContainer: 93 +'px',
          margeHaut: -108 +'px',
          margeGauche: -524 + 'px',
          margeDivgauche:0,
          margedivHaut: -2,
        },//10
        {
          widthContainer: 61 +'px',
          heightContainer: 100 +'px',
          margeHaut: 0 +'px',
          margeGauche: -4 + 'px',
          margeDivgauche:0,
          margedivHaut: -2,
        },//base
      ],




        coupBas: [{
          widthContainer: 61 +'px',
          heightContainer: 100 +'px',
          margeHaut: -108 +'px',
          margeGauche: -4 + 'px',
          margeDivgauche: 0,
          margedivHaut: 2,
        }, //1bas         
        {
          widthContainer: 61 +'px',
          heightContainer: 100 +'px',
          margeHaut: -295 +'px',
          margeGauche: -4 + 'px',
          margeDivgauche: 0,
          margedivHaut: 2,
        },//2bas
        {
          widthContainer: 61 +'px',
          heightContainer: 100 +'px',
          margeHaut: -295 +'px',
          margeGauche: -68 + 'px',
          margeDivgauche: 0,
          margedivHaut: 2,
        },//3bas
        {
          widthContainer: 78 +'px',
          heightContainer: 100 +'px',
          margeHaut: -295 +'px',
          margeGauche: -137 + 'px',
          margeDivgauche: 0,
          margedivHaut: 2,
        },//4bas
        {
          widthContainer: 69 +'px',
          heightContainer: 100 +'px',
          margeHaut: -295 +'px',
          margeGauche: -216 + 'px',
          margeDivgauche: 0,
          margedivHaut: 2,
        },//5bas
        {
          widthContainer: 86 +'px',
          heightContainer: 100 +'px',
          margeHaut: -295 +'px',
          margeGauche: -285 + 'px',
          margeDivgauche: 0,
          margedivHaut: 2,
        },//6bas
        {
          widthContainer: 61 +'px',
          heightContainer: 100 +'px',
          margeHaut: -295 +'px',
          margeGauche: -68 + 'px',
          margeDivgauche: 0,
          margedivHaut: 2,
        },//3bas
        {
          widthContainer: 61 +'px',
          heightContainer: 100 +'px',
          margeHaut: -108 +'px',
          margeGauche: -4 + 'px',
          margeDivgauche: 0,
          margedivHaut: 2,
        }, //1bas  
        {
          widthContainer: 61 +'px',
          heightContainer: 100 +'px',
          margeHaut: 0 +'px',
          margeGauche: -4 + 'px',
          margeDivgauche: 0,
          margedivHaut: 2,
        },//base
      ],
    
      coupSpecial:[{
        widthContainer: 60 +'px',
        heightContainer: 94 +'px',
        margeHaut: -405 +'px',
        margeGauche: -261 + 'px',
      },
      {
        widthContainer: 60 +'px',
        heightContainer: 94 +'px',
        margeHaut: -405 +'px',
        margeGauche: -324 + 'px',
      },
      {
        widthContainer: 60 +'px',
        heightContainer: 94 +'px',
        margeHaut: -405 +'px',
        margeGauche: -383 + 'px',
      },
      {
        widthContainer: 60 +'px',
        heightContainer: 94 +'px',
        margeHaut: -405 +'px',
        margeGauche: -440 + 'px',
      },
      {
        widthContainer: 60 +'px',
        heightContainer: 94 +'px',
        margeHaut: -405 +'px',
        margeGauche: -497 + 'px',
      },
      {
        widthContainer: 81 +'px',
        heightContainer: 108 +'px',
        margeHaut: -282 +'px',
        margeGauche: -556 + 'px',
      },
      {
        widthContainer: 81 +'px',
        heightContainer: 108 +'px',
        margeHaut: -282 +'px',
        margeGauche: -556 + 'px',
      },
      {
        widthContainer: 81 +'px',
        heightContainer: 108 +'px',
        margeHaut: -282 +'px',
        margeGauche: -556 + 'px',
      },
      // retour coup spe
      {
        widthContainer: 60 +'px',
        heightContainer: 94 +'px',
        margeHaut: -405 +'px',
        margeGauche: -497 + 'px',
      },
      {
        widthContainer: 60 +'px',
        heightContainer: 94 +'px',
        margeHaut: -405 +'px',
        margeGauche: -440 + 'px',
      },
      {
        widthContainer: 60 +'px',
        heightContainer: 94 +'px',
        margeHaut: -405 +'px',
        margeGauche: -383 + 'px',
      },
      {
        widthContainer: 60 +'px',
        heightContainer: 94 +'px',
        margeHaut: -405 +'px',
        margeGauche: -324 + 'px',
      },
      {
        widthContainer: 60 +'px',
        heightContainer: 108 +'px',
        margeHaut: -293 +'px',
        margeGauche: -637 + 'px',
      },
      {
        widthContainer: 61 +'px',
        heightContainer: 100 +'px',
        margeHaut: 0 +'px',
        margeGauche: -4 + 'px',
      },
    ]
      };
      //√ânonc√© :
      /*
        En JavaScript, on a acc√®s √† des objets qui contiennent les informations relatives au navigateurs Internet : le DOM. L'objet qui permet d'acc√©der au DOM est l'objet window. Cet objet est l'objet de plus haut niveau en JavaScript. L'objet window contient des sous objets que nous allons exploiter.
        
        Lorsque le navigateur Internet ex√©cute la m√©thode correspondant √† un √©v√®nement, il lui transmet en param√®tre un objet d'√©v√©nement, cet objet d'√©v√©nement contient des informations relatives √† l'√©v√®nement qui est survenu. Les objets d'√©v√®nements sont document√©s ici dans le MDN : https://developer.mozilla.org/fr/docs/Web/API/Event
      */
      
      /*
        1. Que fait le code ci-dessous ? Au chargement du document, lorsqu'on presse une touche, on r√©cup√®re le code correspondant √† la touche. Selon ce code, on affiche une boite de dialogue. Essayez ce code.
      */

      

      window.onload = function(){
        window.onkeydown = function(event){
         

          var code = event.keyCode;

          switch(code){
            case 37:
              //*instructions*
              // alert('gauche');           
              // deplacerSriteGauche();
              inverseImage();
              deplacer(recule);
               
                       
            break;
            
            case 38:
              //instructions
              // alert('haut');          
              // deplacerSpriteHaut();
              deplacer(saute)
              // avanceHaut();
            break;

            case 39:
              //instructions
              // alert('droite');          
              // deplacerSpriteDroite(); 
              redresseImage();
              deplacer(avanceVersDroite);
            break;

            case 40:
              //instructions
              // alert('bas');
              // deplacerSpriteBas();
          deplacer(coupAuSol);
            break;

            case 13:
              deplacer(coupSpecial);
              break; 

          };

        };

      };
      
      /*
        Ce document comporte une balise img dans une div. La div sert de masque pour le sprite charg√© √† l'aide de la balise img. Un sprite est une image qui pr√©sent les d√©compositions d'un mouvement.
      */

      /*
        1. Cherchez un sprite sur Google. Chargez le sprite dans le document Web ci-contre. Param√©trez les styles de la div masque pour que une seule d√©composition de mouvement du sprite soit visible (utilisez la propri√©t√© de style overflow:hidden). La div doit √™tre en position absolute. L'img dans la div doit √™tre en position absolute.
      */

      /*
        2. En utilisant comme base le code fourni, lorsque je presse une direction, d√©clenchez du code Javascript (dans la zone avec le sigle *instructions*) qui va d√©placer de 2px dans cette direction la div masque.
      */

      /*
        3. En utilisant comme base le code fourni, lorsque je presse la m√™me direction, d√©clenchez du code Javascript (dans la zone avec le sigle *instructions*) qui va d√©placer l'img dans le masque dans la direction oppos√©e au d√©placement pr√©c√©dent pour afficher la d√©composition suivante du mouvement.
      */

      /*
        4. Reproduire cela pour les directions restantes.
      */

      /*
        5. Trouvez le code num√©rique qui correspond √† la touche "entr√©e". Dans le cas ou l'utilisateur appuie sur la touche entr√©e, affichez un "mouvement sp√©cial" de votre sprite (coup d'√©p√©e, explosion, etc... ou autre). L'√©v√©nement contraire de onkeydown est onkeyup. Inspirez vous du code fourni pour faire en sorte que lorsque l'utilisateur rel√¢che la touche entr√©e, le sprite revienne √† son √©tat initial.
      */
    </script>
    <style>

      #container {
        height: 100px;
        width: 61px;
        position: absolute;
        overflow: hidden;
      }

      #contenu {
        margin-top: 0px;
        margin-left: -4px;
      }

      



    </style>
  </head>
  <body>
    <h1>Play !</h1>
    <div>
      <div id="container" class="masque" >
        <img id="contenu" class="sprite" src="Goku.gif"/>
      </div>
    </div>
    <noscript>
      <p>Veuillez activer JavaScript</p>
    </noscript>
    <script>
/**
 * 
 * DEPLACEMENT DU CARDRE CONTENANT LE SPRITE  
 */
var leSprite = document.getElementById('container');

//  var deplacerSriteGauche = function() {
//   var margeGauche = leSprite.style.marginLeft;
//   margeGauche = parseFloat(margeGauche);
//   if (isNaN(margeGauche)){
//   margeGauche = 0;
//   }
//   margeGauche = margeGauche - 2;
//    leSprite.style.marginLeft = margeGauche + 'px'; 
//  };

//  var deplacerSpriteHaut = function() {
//   var margeHaut = leSprite.style.marginTop;
//   margeHaut = parseFloat(margeHaut);
//   if (isNaN(margeHaut)){
//     margeHaut = 0;
//   }
//   margeHaut = margeHaut - 2;
//    leSprite.style.marginTop = margeHaut + 'px';             
//  };

//  var deplacerSpriteDroite = function() {
//   var margeGauche = leSprite.style.marginLeft;
//   margeGauche = parseFloat(margeGauche);
//   if (isNaN(margeGauche)){
//     margeGauche = 0;
//   }
//   margeGauche = margeGauche + 2;
//   leSprite.style.marginLeft = margeGauche + 'px'; 
//  };

//  var deplacerSpriteBas = function() {
//   var margeHaut = leSprite.style.marginTop;
//   margeHaut = parseFloat(margeHaut);
//   if (isNaN(margeHaut)){
//     margeHaut = 0;
//   }
//   margeHaut = margeHaut + 2;
//   leSprite.style.marginTop = margeHaut + 'px';
//  };






 /**
  * DEPLACEMENT DE l'IMAGE DANS LE SPRITE
  */ 
var imageSprite = document.getElementById('contenu');
var avanceVersDroite = interpolationDuSprite.avancer;
var recule = interpolationDuSprite.reculer;
var coupSpecial = interpolationDuSprite.coupSpecial;
var saute = interpolationDuSprite.sauter;
var coupAuSol = interpolationDuSprite.coupBas;
var widthContainer = leSprite.style.width;
var heightContainer = leSprite.style.height;
var margeHaut = imageSprite.style.marginTop;
var margeGauche = imageSprite.style.marginLeft;



// fonction qui prend en argument le tableau de mouvements 
var deplacer = function(direction) {  
  var i = 0;        
     var bouge = setInterval(function() {
            if ( i< direction.length) {
            widthContainer =  direction[i].widthContainer;
            widthContainer = parseFloat(widthContainer);
            leSprite.style.width = widthContainer + 'px';
            heightContainer = direction[i].heightContainer;
            heightContainer = parseFloat(heightContainer);
            leSprite.style.height = heightContainer + 'px';
            margeHaut = direction[i].margeHaut;
            margeHaut = parseFloat(margeHaut);
            imageSprite.style.marginTop = margeHaut + 'px';
            margeGauche = direction[i].margeGauche;
            margeGauche = parseFloat(margeGauche);
            imageSprite.style.marginLeft = margeGauche + 'px';

           var margeGauche = leSprite.style.marginLeft;
           margeGauche = parseFloat(margeGauche);
           if(isNaN(margeGauche)){
             margeGauche =0;
           }
           margeGauche = margeGauche + parseFloat(direction[i].margeAgauche) + 'px';

           var margeHaut = leSprite.style.marginTop;
           margeHaut = parseFloat(margeHaut);
           if(isNaN(margeHaut)){
             margeHaut =0;
           }
           margeHaut = margeHaut + parseFloat(direction[i].margeEnHaut) + 'px';



            
            i++;
            console.log(direction[i])
            
            if ( i == direction.length) {
              clearInterval(bouge)
            }
          };
           
     },100);        
};

var conteneur = window.document.getElementById('container')
var inverseImage = function() {
  leSprite.style.transform = 'scaleX(-1)'
}
var redresseImage = function() {
  leSprite.style.transform = 'scaleX(1)';
}



  // fonction pour retour en position initiale

var retourPositionInitiale = function() {
   widthContainer = interpolationDuSprite.positionDeBase.widthContainer ;
   widthContainer = parseFloat(widthContainer);
   leSprite.style.width = widthContainer + 'px';
   heightContainer =interpolationDuSprite.positionDeBase.heightContainer;
   heightContainer = parseFloat(heightContainer);
   leSprite.style.height = heightContainer + 'px';
   margeHaut = interpolationDuSprite.positionDeBase.margeHaut;
   margeHaut = parseFloat(margeHaut);
   imageSprite.style.marginTop = margeHaut + 'px';
   margeGauche = interpolationDuSprite.positionDeBase.margeGauche;
   margeGauche = parseFloat(margeGauche)
   imageSprite.style.marginLeft = margeGauche + 'px';

}
  

  



  // window.document.children[0].children[1].style.backgroundColor = "rgb(128,0,0)";
    </script>
  </body>
</html>